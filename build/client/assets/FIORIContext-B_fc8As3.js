import{r as u,j as P}from"./index-Ivv8m7sf.js";var r=(t=>(t[t.ADD_TO_SAVED=0]="ADD_TO_SAVED",t[t.ADD_TO_LOST=1]="ADD_TO_LOST",t[t.PACK_STATE=2]="PACK_STATE",t[t.NEW_PACK=3]="NEW_PACK",t[t.FLIP_CARD=4]="FLIP_CARD",t[t.RIP_CARD=5]="RIP_CARD",t[t.RESET_PACK_STATE=6]="RESET_PACK_STATE",t[t.UPDATE_PACK_STATE=7]="UPDATE_PACK_STATE",t[t.PACK_COMPLETED=8]="PACK_COMPLETED",t[t.PACK_STARTED=9]="PACK_STARTED",t[t.SET_HARD_MODE=10]="SET_HARD_MODE",t))(r||{});const S=u.createContext(null),E=u.createContext(null);function m(t,a){return{...t,amountSaved:t.amountSaved+a.amount}}function A(t,a){return{...t,amountLost:t.amountLost+a.amount}}function p(t,a){if(t.action===a.action)return t;if(!["NONE","FLIP","RIP","END"].includes(a.action))throw Error("Unknown action: "+a.action);return{...t,action:a.action}}function I(t,a){return{...t,action:"RIP",amountSaved:t.amountSaved+a.amountSaved,packState:t.packState.map(e=>e.id===a.id?{id:a.id,status:"FLIPPED",rotation:0,maskImage:-1}:e)}}function d(t,a){return{...t,action:"RIP",amountSaved:t.amountSaved+a.amountSaved}}function f(t,a){return{...t,action:"FLIP",amountLost:t.amountLost+a.amountLost,packState:t.packState.map(e=>e.id===a.id?{...e,id:a.id,status:"RIPPED"}:e)}}function s(t,a){console.log("resetPackState",a.size);const e=initializeCardStateArray(a.size);return{...t,packState:e}}function O(t){return{...t,packCompleted:!0}}function l(t){return{...t,action:"FLIP",packCompleted:!1}}function L(t,a){return{...t,hardMode:a.hardMode}}function K({children:t}){const a={action:"FLIP",amountLost:0,amountSaved:0,packCompleted:!1,hardMode:!1,packState:[{id:0,status:"NONE",rotation:0,maskImage:0}]},e=new Map([[r.ADD_TO_SAVED,(n,o)=>m(n,o)],[r.ADD_TO_LOST,(n,o)=>A(n,o)],[r.PACK_STATE,(n,o)=>p(n,o)],[r.NEW_PACK,(n,o)=>I(n,o)],[r.FLIP_CARD,(n,o)=>d(n,o)],[r.RIP_CARD,(n,o)=>f(n,o)],[r.RESET_PACK_STATE,(n,o)=>s(n,o)],[r.PACK_COMPLETED,(n,o)=>O(n)],[r.PACK_STARTED,(n,o)=>l(n)],[r.SET_HARD_MODE,(n,o)=>L(n,o)]]);function T(n,{type:o,payload:i}){const _=e.get(o);return _?_(n,i):(console.warn("⚠️ No action found for type:",o),n)}const[C,D]=u.useReducer(T,a);return P.jsx(S.Provider,{value:C,children:P.jsx(E.Provider,{value:D,children:t})})}function v(){return u.useContext(S)}function F(){return u.useContext(E)}export{K as F,r as R,v as a,F as u};
