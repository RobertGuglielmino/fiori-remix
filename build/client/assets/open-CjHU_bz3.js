import{r as u,j as a,d as C,i as E}from"./index-CNcSpTgT.js";import{c as y}from"./centsToDollars-BemH1-NO.js";import{u as w,a as P,R as I}from"./FIORIContext-Cl75LApW.js";import{u as b}from"./components-BLxEVhed.js";function N({src:e,alt:n,handleCardClick:r}){const[s,i]=u.useState({}),o=u.useRef(null),c=u.useRef(null),d=u.useRef(!1),g=15,x=u.useCallback(k=>{!d.current||!o.current||(c.current&&cancelAnimationFrame(c.current),c.current=requestAnimationFrame(()=>{if(o.current){const t=o.current.getBoundingClientRect(),l=k.clientX-t.left,p=k.clientY-t.top,v=t.width/2,h=t.height/2,j=(p-h)/h*-15,R=(l-v)/v*g;i({transform:`perspective(1000px) rotateX(${j}deg) rotateY(${R}deg) translateZ(20px) scale(1.02)`,boxShadow:"0 10px 20px rgba(0, 0, 0, 0.2)"})}}))},[]),m=u.useCallback(()=>{d.current=!0,i({transform:"translateZ(20px) scale(1.02)",boxShadow:"0 10px 20px rgba(0, 0, 0, 0.2)"})},[]),f=u.useCallback(()=>{d.current=!1,c.current&&(cancelAnimationFrame(c.current),c.current=null),i({transform:"",boxShadow:""})},[]);return a.jsx("div",{className:"relative w-full h-full relative",children:a.jsx("div",{ref:o,className:"w-full h-full rounded-lg shadow-xl overflow-hidden transition-all duration-200 ease-out",style:{...s,transformStyle:"preserve-3d",willChange:"transform"},onMouseEnter:m,onMouseMove:x,onMouseLeave:f,children:a.jsx("img",{src:e,alt:n||"Interactive image",className:"w-full h-full object-cover ",loading:"lazy",onClick:()=>r()})})})}const S="/assets/mtg_back-xLlnET8g.png";function D({maskImage:e,maskPosition:n,src:r}){const s=["mask-image-[url(/images/masks/mask1.png)]","mask-image-[url(/images/masks/mask2.png)]","mask-image-[url(/images/masks/mask3.png)]","mask-image-[url(/images/masks/mask4.png)]","mask-image-[url(/images/masks/mask5.png)]"];return a.jsx("div",{className:"relative w-full h-full",children:a.jsx("img",{src:r,className:`w-full h-full object-cover relative overflow-hidden rounded-xl transition-all duration-500 scale-90 grayscale rotate-[3deg] rayscale ${s[e]} scale-[90%] mask-position-[50%_50%] mask-size-cover`})})}function M({src:e,alt:n,foil:r}){return a.jsxs("div",{className:"relative w-full h-full relative",children:[a.jsx("img",{src:e,alt:n||"Interactive image",className:"w-full h-full object-cover rounded-xl",loading:"lazy"}),r&&a.jsx("div",{className:"absolute inset-0 bg-foil-ray bg-400 animate-foil pointer-events-none rounded-lg"})]})}function O({name:e,cents:n,image:r,status:s,foil:i,rotation:o,maskImage:c,handleCardClick:d}){const[g,x]=u.useState("25%_25%");let m=s==="FLIPPED"||s==="RIPPED";const f="Â ";return a.jsxs("div",{className:"flex flex-col items-center rounded-lg",children:[s==="NONE"&&a.jsx(N,{src:S,alt:"test",handleCardClick:()=>d()}),s==="FLIPPED"&&a.jsx(M,{src:r,alt:"test",foil:i}),s==="RIPPED"&&a.jsx(D,{src:r,maskImage:c,maskPosition:g}),a.jsx("div",{className:"font-kanit text-center text-sm",children:m?e:f}),a.jsx("div",{className:"font-kanit text-center text-sm",children:m?y(n):f})]})}function A(){let e=localStorage.getItem("flipOrRipUserId");return e?console.log("Retrieved existing user ID:",e):(e=crypto.randomUUID(),localStorage.setItem("flipOrRipUserId",e),console.log("Created new user ID:",e)),e}async function L(e,n,r){await fetch("https://s8ib0k5c81.execute-api.us-east-1.amazonaws.com/prod/flip-or-rip-lambda/stats",{method:"POST",body:JSON.stringify({cardStatusList:e,userId:n,packId:r}),headers:{"Content-Type":"application/json"}}).then(async s=>{const i=await s.json();return console.log("Loader data received:",i),i})}function T(){const e=w(),n=P(),r=b().body,s=r.cards,i=r.packId,[o,c]=u.useState(F(s.length)),d=(t,l)=>{switch(l){case"FLIP":g(t);break;case"RIP":x(t);break}};return a.jsx("div",{className:"flex flex-wrap justify-center sm:px-4 sm:px-8 lg:px-16 py-4",children:s.map((t,l)=>a.jsx("div",{className:"grow-0 shrink sm:basis-[24vw] md:basis-[20vw] lg:basis-[12vw] p-2",children:a.jsx(O,{index:l,...t,status:o[l].status,foil:s[l].foil,rotation:o[l].rotation,maskImage:o[l].maskImage,handleCardClick:()=>d(l,n.action)},s[l].scryfallId)}))});function g(t){const l=s[t].cents;c(o.map(p=>p.id===t?{id:t,status:"FLIPPED",rotation:0,maskImage:-1}:p)),e({type:I.FLIP_CARD,payload:{amountSaved:l}}),m()}function x(t){const l=s[t].cents,p=o[t].rotation,v=o[t].maskImage;c(o.map(h=>h.id===t?{id:t,status:"RIPPED",rotation:p,maskImage:v}:h)),e({type:I.RIP_CARD,payload:{amountLost:l}}),m()}function m(){z(o)&&(console.log("All cards have been flipped or ripped"),f(),k(),L(o,A(),i))}function f(){e({type:I.PACK_STATE,payload:{action:"END"}})}function k(){e({type:I.PACK_COMPLETED,payload:{}})}}function F(e){const n=[];for(let r=0;r<e;r++)n.push({id:r,status:"NONE",rotation:_(),maskImage:U()});return n}function _(){return Math.floor(Math.random()*7)-3}function U(){return Math.floor(Math.random()*5)}function z(e){return e.filter(n=>n.status=="NONE").length==1}function K(){const e=C();return console.log("IN THE OPEN ROUTE ERROR"),E(e)?a.jsxs("div",{children:[a.jsxs("h1",{children:[e.status," ",e.statusText]}),a.jsx("p",{children:e.data})]}):e instanceof Error?a.jsxs("div",{children:[a.jsx("h1",{children:"Error"}),a.jsx("p",{children:e.message}),a.jsx("p",{children:"The stack trace is:"}),a.jsx("pre",{children:e.stack})]}):a.jsx("h1",{children:"Unknown Error"})}function $(){return a.jsx("div",{className:"",id:"index-page",children:a.jsx(T,{})})}export{K as ErrorBoundary,$ as default};
